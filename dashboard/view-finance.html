<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Finanzen · Dashboard</title>
  <meta name="robots" content="noindex,nofollow" />
  <meta name="theme-color" content="#0b1220" />

  <!-- Shell (Sidebar/Topbar) -->
  <link rel="stylesheet" href="./shell.css" />

  <!-- Auth -->
  <script src="./auth.js"></script>
  <script>Auth.requireAuth({ loginUrl:"./login.html" });</script>

  <!-- Shell + Excel Loader -->
  <script src="./shell.js"></script>
  <script src="./excel-loader.js"></script>

  <style>
    /* No horizontal scroll – ever */
    html,body{ overflow-x:hidden !important; }
    .main, .content, .container{ min-width:0; }
    .card, .card-body{ min-width:0; }

    .fin-grid{
      display:grid;
      grid-template-columns: repeat(12, minmax(0,1fr));
      gap: var(--gap);
      min-width:0;
      align-items: stretch;
    }
    .span12{ grid-column: span 12; min-width:0; }
    .span6{ grid-column: span 6; min-width:0; }

    @media (max-width: 900px){
      .span6{ grid-column: span 12; }
    }

    /* Equal-height rows (pairs) */
    .row-equal .card{
      height: 100%;
      display:flex;
      flex-direction:column;
      min-height:0;
    }
    .row-equal .card-body{
      flex:1 1 auto;
      min-height:0;
      display:flex;
      padding: 12px 14px 14px;
    }
    .slot{
      width:100%;
      min-width:0;
      flex:1 1 auto;
      min-height:0;
    }

    /* Budget bigger */
    .budget-big .card-body{
      padding: 16px 16px 18px;
    }

    .alert{
      border-radius:14px;
      border:1px solid rgba(248,113,113,.35);
      background: rgba(248,113,113,.08);
      padding:12px 14px;
      color: rgba(226,232,240,.92);
      font-size:12px;
      line-height:1.35;
      white-space: pre-wrap;
      overflow-wrap:anywhere;
    }
    .alert strong{ font-weight:950; }
  </style>
</head>

<body>
  <div id="app"></div>

  <template id="pageTpl">
    <section class="fin-grid">

      <!-- 1) Gesamtübersicht oben -->
      <section class="span12">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Gesamtübersicht</div>
              <div class="card-sub">Cashflow, Mieten, OP & Reserven – kompakt und Apple-clean.</div>
            </div>
          </div>
          <div class="card-body" style="padding:14px;">
            <div class="slot" id="slotGesamt"></div>
          </div>
        </div>
      </section>

      <!-- 2) Cashflow + Mieten (gleich hoch) -->
      <section class="span6 row-equal">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Cashflow</div>
              <div class="card-sub">6M Rückblick · 3M Forecast</div>
            </div>
          </div>
          <div class="card-body">
            <div class="slot" id="slotCashflow"></div>
          </div>
        </div>
      </section>

      <section class="span6 row-equal">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Mieten & Pacht</div>
              <div class="card-sub">Einnahmen, Auslastung, nächste Fälligkeit</div>
            </div>
          </div>
          <div class="card-body">
            <div class="slot" id="slotMieten"></div>
          </div>
        </div>
      </section>

      <!-- 3) OP + Reserven (gleich hoch wie Reihe 2) -->
      <section class="span6 row-equal">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">OP – Offene Posten</div>
              <div class="card-sub">Fälligkeiten, überfällig, Priorität</div>
            </div>
          </div>
          <div class="card-body">
            <div class="slot" id="slotOP"></div>
          </div>
        </div>
      </section>

      <section class="span6 row-equal">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Reserven</div>
              <div class="card-sub">Puffer, Runway, Zielkorridor</div>
