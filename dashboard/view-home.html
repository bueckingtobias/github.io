<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>Home · Dashboard</title>

  <link rel="stylesheet" href="./shell.css">

  <script src="./auth.js"></script>
  <script>Auth.requireAuth({ loginUrl:"./login.html" });</script>

  <script src="./shell.js"></script>
  <script src="./excel-loader.js"></script>
</head>

<body>
<div id="app"></div>

<template id="pageTpl">
  <section class="grid">
    <section class="card" style="grid-column:span 6;">
      <div class="card-header">
        <div>
          <div class="card-title">Wetter</div>
          <div class="card-sub">Kompakt</div>
        </div>
      </div>
      <div class="card-body" id="home-weather">Wetter-Modul</div>
    </section>

    <section class="card" style="grid-column:span 6;">
      <div class="card-header">
        <div>
          <div class="card-title">Kalender</div>
          <div class="card-sub">Feiertage & Countdown</div>
        </div>
      </div>
      <div class="card-body" id="home-calendar">Kalender-Modul</div>
    </section>

    <section class="card" style="grid-column:span 12;">
      <div class="card-header">
        <div>
          <div class="card-title">KPIs</div>
          <div class="card-sub">aus Excel</div>
        </div>
      </div>
      <div class="card-body" id="home-kpis"></div>
    </section>
  </section>
</template>

<script>
(async function(){
  Shell.mount({ active:"./view-home.html", title:"Home", sub:"Übersicht" });

  await ExcelLoader.load("./Dashboard.xlsx");

  const kpis = window.IMMO_DATA.home;
  const el = document.getElementById("home-kpis");

  el.innerHTML = `
    <div class="tiles">
      ${kpis.map(k=>`
        <div class="tile">
          <div class="k">${k.KPI}</div>
          <div class="v">${k.Wert} ${k.Einheit}</div>
          <div class="h">${k.Kommentar||""}</div>
        </div>
      `).join("")}
    </div>
  `;
})();
</script>
</body>
</html>